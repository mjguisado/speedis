config:
  payload:
    # path is relative to the location of the test script
    path: 'uuids.csv'
    delimiter: 'â‚¬' # Just on fields with commas caracters in it.
    fields:
      - 'uuid'
  # This is a test server run by team Artillery
  # It's designed to be highly scalable
  target: http://localhost:3001
  phases:
    - duration: 15m
      arrivalRate: 500
scenarios:
  - name: '304'
    flow:
    - get:
        url: '/mocks/mocks/items/{{ uuid }}?cc=public,max-age={{ $randomNumber(1,60) }}'
        capture:
          - header: 'last-modified'
            as: 'lastModified'
    - think: '{{ $randomNumber(1,60) }}s'
    - get:
        url: '/mocks/mocks/items/{{  uuid }}?cc=public,max-age={{ $randomNumber(1,60) }}'
        headers:
          'If-Modified-Since': '{{ lastModified }}'
        ifTrue: 'lastModified'
  - name: 'overflow'
    flow:
    - get:
        url: '/mocks/mocks/items/overflow?cc=public,max-age=10'